import os
import logging
import asyncio
import requests
from aiogram import Bot, Dispatcher, F
from aiogram.enums import ParseMode
from aiogram.filters import CommandStart
from aiogram.types import Message, ReplyKeyboardMarkup, KeyboardButton
from aiogram.client.default import DefaultBotProperties
from dotenv import load_dotenv

# --- Ğ—Ğ°Ğ³Ñ€ÑƒĞ¶Ğ°ĞµĞ¼ Ğ¿ĞµÑ€ĞµĞ¼ĞµĞ½Ğ½Ñ‹Ğµ Ğ¾ĞºÑ€ÑƒĞ¶ĞµĞ½Ğ¸Ñ ---
load_dotenv()

# --- ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ¸ ---
BOT_TOKEN = os.getenv("BOT_TOKEN")
OPENROUTER_KEY = os.getenv("OPENROUTER_KEY")
COLLEGE_NAME = os.getenv("COLLEGE_NAME", "ĞšĞ°Ñ€Ğ°Ğ³Ğ°Ğ½Ğ´Ğ¸Ğ½ÑĞºĞ¸Ğ¹ ĞºĞ¾Ğ»Ğ»ĞµĞ´Ğ¶ Ñ‚ĞµÑ…Ğ½Ğ¾Ğ»Ğ¾Ğ³Ğ¸Ğ¹ Ğ¸ ÑĞµÑ€Ğ²Ğ¸ÑĞ°")
SCHEDULE_URL = os.getenv("SCHEDULE_URL")
SITE_URL = os.getenv("SITE_URL")

# --- Ğ›Ğ¾Ğ³Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ ---
logging.basicConfig(level=logging.INFO)
logger = logging.getLogger(__name__)

# --- Ğ˜Ğ½Ğ¸Ñ†Ğ¸Ğ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ Ğ±Ğ¾Ñ‚Ğ° ---
bot = Bot(token=BOT_TOKEN, default=DefaultBotProperties(parse_mode=ParseMode.HTML))
dp = Dispatcher()

# --- Ğ¡Ğ¸ÑÑ‚ĞµĞ¼Ğ½Ğ°Ñ Ğ¸Ğ½ÑÑ‚Ñ€ÑƒĞºÑ†Ğ¸Ñ ---
COLLEGE_RULES = (
    "Ğ¢Ñ‹ â€” Ğ²Ğ¸Ñ€Ñ‚ÑƒĞ°Ğ»ÑŒĞ½Ñ‹Ğ¹ Ğ¿Ğ¾Ğ¼Ğ¾Ñ‰Ğ½Ğ¸Ğº ĞšĞ°Ñ€Ğ°Ğ³Ğ°Ğ½Ğ´Ğ¸Ğ½ÑĞºĞ¾Ğ³Ğ¾ ĞºĞ¾Ğ»Ğ»ĞµĞ´Ğ¶Ğ° Ñ‚ĞµÑ…Ğ½Ğ¾Ğ»Ğ¾Ğ³Ğ¸Ğ¹ Ğ¸ ÑĞµÑ€Ğ²Ğ¸ÑĞ° (ĞšĞšĞ¢Ğ¸Ğ¡). "
    "ĞÑ‚Ğ²ĞµÑ‡Ğ°Ğ¹ Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ Ğ½Ğ° Ğ²Ğ¾Ğ¿Ñ€Ğ¾ÑÑ‹, ÑĞ²ÑĞ·Ğ°Ğ½Ğ½Ñ‹Ğµ Ñ ĞºĞ¾Ğ»Ğ»ĞµĞ´Ğ¶ĞµĞ¼, Ğ¾Ğ±Ñ€Ğ°Ğ·Ğ¾Ğ²Ğ°Ğ½Ğ¸ĞµĞ¼, Ğ¿Ñ€Ğ¸Ñ‘Ğ¼Ğ¾Ğ¼, Ñ€Ğ°ÑĞ¿Ğ¸ÑĞ°Ğ½Ğ¸ĞµĞ¼, "
    "ÑĞ¿ĞµÑ†Ğ¸Ğ°Ğ»ÑŒĞ½Ğ¾ÑÑ‚ÑĞ¼Ğ¸, ĞºĞ¾Ğ½Ñ‚Ğ°ĞºÑ‚Ğ°Ğ¼Ğ¸ Ğ¸ ÑÑ‚ÑƒĞ´ĞµĞ½Ñ‡ĞµÑĞºĞ¾Ğ¹ Ğ¶Ğ¸Ğ·Ğ½ÑŒÑ. "
    "Ğ•ÑĞ»Ğ¸ Ğ²Ğ¾Ğ¿Ñ€Ğ¾Ñ Ğ½Ğµ ĞºĞ°ÑĞ°ĞµÑ‚ÑÑ ĞºĞ¾Ğ»Ğ»ĞµĞ´Ğ¶Ğ° Ğ¸Ğ»Ğ¸ Ğ¾Ğ±Ñ€Ğ°Ğ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ â€” Ğ²ĞµĞ¶Ğ»Ğ¸Ğ²Ğ¾ Ğ¾Ñ‚ĞºĞ°Ğ¶Ğ¸ÑÑŒ Ğ¾Ñ‚Ğ²ĞµÑ‡Ğ°Ñ‚ÑŒ, "
    "Ğ½Ğ°Ğ¿Ñ€Ğ¸Ğ¼ĞµÑ€: Â«Ğ˜Ğ·Ğ²Ğ¸Ğ½Ğ¸Ñ‚Ğµ, Ñ Ğ¼Ğ¾Ğ³Ñƒ Ğ¾Ñ‚Ğ²ĞµÑ‡Ğ°Ñ‚ÑŒ Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ Ğ½Ğ° Ğ²Ğ¾Ğ¿Ñ€Ğ¾ÑÑ‹, ÑĞ²ÑĞ·Ğ°Ğ½Ğ½Ñ‹Ğµ Ñ ĞºĞ¾Ğ»Ğ»ĞµĞ´Ğ¶ĞµĞ¼ ĞšĞšĞ¢Ğ¸Ğ¡.Â» "
    "ĞÑ‚Ğ²ĞµÑ‡Ğ°Ğ¹ Ğ´Ñ€ÑƒĞ¶ĞµĞ»ÑĞ±Ğ½Ğ¾, ĞºÑ€Ğ°Ñ‚ĞºĞ¾ Ğ¸ Ğ¸Ğ½Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ‚Ğ¸Ğ²Ğ½Ğ¾."
)

# --- ĞšĞ»Ğ°Ğ²Ğ¸Ğ°Ñ‚ÑƒÑ€Ğ° ---
def get_main_keyboard() -> ReplyKeyboardMarkup:
    return ReplyKeyboardMarkup(
        keyboard=[
            [KeyboardButton(text="ğŸ“… Ğ Ğ°ÑĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ"), KeyboardButton(text="ğŸ“ ĞŸÑ€Ğ¸Ñ‘Ğ¼Ğ½Ğ°Ñ ĞºĞ¾Ğ¼Ğ¸ÑÑĞ¸Ñ")],
            [KeyboardButton(text="ğŸ“ ĞšĞ¾Ğ½Ñ‚Ğ°ĞºÑ‚Ñ‹"), KeyboardButton(text="â° Ğ Ğ°ÑĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ Ğ·Ğ²Ğ¾Ğ½ĞºĞ¾Ğ²")],
        ],
        resize_keyboard=True,
        input_field_placeholder="Ğ’Ñ‹Ğ±ĞµÑ€Ğ¸Ñ‚Ğµ Ñ€Ğ°Ğ·Ğ´ĞµĞ»..."
    )

# --- Ğ“ĞµĞ½ĞµÑ€Ğ°Ñ†Ğ¸Ñ Ğ¾Ñ‚Ğ²ĞµÑ‚Ğ° Ñ‡ĞµÑ€ĞµĞ· OpenRouter ---
async def generate_reply(prompt: str) -> str:
    try:
        logger.info("ğŸ§  ĞÑ‚Ğ¿Ñ€Ğ°Ğ²ĞºĞ° Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑĞ° Ğ² OpenRouter...")

        headers = {
            "Authorization": f"Bearer {OPENROUTER_KEY}",
            "Content-Type": "application/json",
            "X-Title": "KKTiS College Bot"
        }

        data = {
            "model": "deepseek/deepseek-chat-v3-0324:free",
            "messages": [
                {"role": "system", "content": COLLEGE_RULES},
                {"role": "user", "content": prompt},
            ],
        }

        response = requests.post(
            "https://openrouter.ai/api/v1/chat/completions",
            headers=headers,
            json=data,
            timeout=60
        )

        print("STATUS:", response.status_code)
        print("BODY:", response.text)

        if response.status_code != 200:
            logger.error(f"âŒ ĞÑˆĞ¸Ğ±ĞºĞ° OpenRouter: {response.status_code} - {response.text}")
            return f"âš ï¸ ĞÑˆĞ¸Ğ±ĞºĞ° Ğ¿Ñ€Ğ¸ Ğ¾Ğ±Ñ€Ğ°Ñ‰ĞµĞ½Ğ¸Ğ¸ Ğº OpenRouter API:\n\n{response.text}"

        rj = response.json()
        return rj["choices"][0]["message"]["content"].strip()

    except requests.exceptions.Timeout:
        return "â³ Ğ¡ĞµÑ€Ğ²ĞµÑ€ OpenRouter Ğ½Ğµ Ğ¾Ñ‚Ğ²ĞµÑ‚Ğ¸Ğ» Ğ²Ğ¾Ğ²Ñ€ĞµĞ¼Ñ. ĞŸĞ¾Ğ¿Ñ€Ğ¾Ğ±ÑƒĞ¹ Ğ¿Ğ¾Ğ·Ğ¶Ğµ."
    except Exception as e:
        logger.error(f"âŒ ĞÑˆĞ¸Ğ±ĞºĞ° Ğ¿Ñ€Ğ¸ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğµ Ñ OpenRouter: {e}")
        return f"ğŸ˜” ĞĞµ ÑƒĞ´Ğ°Ğ»Ğ¾ÑÑŒ Ğ¿Ğ¾Ğ»ÑƒÑ‡Ğ¸Ñ‚ÑŒ Ğ¾Ñ‚Ğ²ĞµÑ‚ Ğ¾Ñ‚ Ğ¼Ğ¾Ğ´ĞµĞ»Ğ¸.\n\nĞÑˆĞ¸Ğ±ĞºĞ°: {e}"

# --- ĞšĞ¾Ğ¼Ğ°Ğ½Ğ´Ğ° /start ---
@dp.message(CommandStart())
async def cmd_start(message: Message):
    welcome_text = (
        f"ğŸ“ <b>{COLLEGE_NAME}</b>\n\n"
        f"ğŸ‘‹ Ğ—Ğ´Ñ€Ğ°Ğ²ÑÑ‚Ğ²ÑƒĞ¹Ñ‚Ğµ, <b>{message.from_user.first_name}</b>!\n\n"
        f"Ğ¯ â€” Ğ¾Ñ„Ğ¸Ñ†Ğ¸Ğ°Ğ»ÑŒĞ½Ñ‹Ğ¹ Ğ±Ğ¾Ñ‚ ĞºĞ¾Ğ»Ğ»ĞµĞ´Ğ¶Ğ°. Ğ’Ñ‹Ğ±ĞµÑ€Ğ¸Ñ‚Ğµ Ğ½ÑƒĞ¶Ğ½Ñ‹Ğ¹ Ñ€Ğ°Ğ·Ğ´ĞµĞ» ğŸ‘‡"
    )
    await message.answer(welcome_text, reply_markup=get_main_keyboard())

# --- ĞšĞ½Ğ¾Ğ¿ĞºĞ¸ ---
@dp.message(F.text == "ğŸ“… Ğ Ğ°ÑĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ")
async def show_schedule(message: Message):
    await message.answer(
        f"ğŸ“… <b>Ğ Ğ°ÑĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ Ğ·Ğ°Ğ½ÑÑ‚Ğ¸Ğ¹:</b>\n\nğŸ”— <a href='{SCHEDULE_URL}'>ĞÑ‚ĞºÑ€Ñ‹Ñ‚ÑŒ Ñ€Ğ°ÑĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ</a>\n\nğŸŒ {SITE_URL}",
        parse_mode=ParseMode.HTML,
        disable_web_page_preview=True
    )

@dp.message(F.text == "ğŸ“ ĞšĞ¾Ğ½Ñ‚Ğ°ĞºÑ‚Ñ‹")
async def show_contacts(message: Message):
    await message.answer(
        "ğŸ“ <b>ĞšĞ¾Ğ½Ñ‚Ğ°ĞºÑ‚Ñ‹:</b>\nĞšĞ°Ñ€Ğ°Ğ³Ğ°Ğ½Ğ´Ğ°, ÑƒĞ». Ğ—Ğ°Ñ‚Ğ°ĞµĞ²Ğ¸Ñ‡Ğ°, 75\nâ˜ï¸ 8-7212-37-58-44\nâœ‰ï¸ krg-koll-7092@bilim09.kzu.kz",
        parse_mode=ParseMode.HTML
    )

```python
@dp.message(F.text == "ğŸ“ ĞŸÑ€Ğ¸Ñ‘Ğ¼Ğ½Ğ°Ñ ĞºĞ¾Ğ¼Ğ¸ÑÑĞ¸Ñ")
async def show_admission(message: Message):
    """
    ĞĞ±Ñ€Ğ°Ğ±Ğ¾Ñ‚Ñ‡Ğ¸Ğº ĞºĞ½Ğ¾Ğ¿ĞºĞ¸ "ĞŸÑ€Ğ¸Ñ‘Ğ¼Ğ½Ğ°Ñ ĞºĞ¾Ğ¼Ğ¸ÑÑĞ¸Ñ"
    ĞÑ‚Ğ¿Ñ€Ğ°Ğ²Ğ»ÑĞµÑ‚ Ğ²ÑÑ Ğ¸Ğ½Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ†Ğ¸Ñ Ğ¾Ğ´Ğ½Ğ¸Ğ¼ ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸ĞµĞ¼
    """
    admission_text = (
        f"â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—\n"
        f"   ğŸ“ <b>ĞŸĞ Ğ˜ĞĞœĞĞĞ¯ ĞšĞĞœĞ˜Ğ¡Ğ¡Ğ˜Ğ¯</b>\n"
        f"â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n\n"
        f"<b>ĞšĞ“ĞšĞŸ Â«ĞšĞ°Ñ€Ğ°Ğ³Ğ°Ğ½Ğ´Ğ¸Ğ½ÑĞºĞ¸Ğ¹ ĞºĞ¾Ğ»Ğ»ĞµĞ´Ğ¶ Ñ‚ĞµÑ…Ğ½Ğ¾Ğ»Ğ¾Ğ³Ğ¸Ğ¸ Ğ¸ ÑĞµÑ€Ğ²Ğ¸ÑĞ°Â» Ğ¾ÑÑƒÑ‰ĞµÑÑ‚Ğ²Ğ»ÑĞµÑ‚ Ğ½Ğ°Ğ±Ğ¾Ñ€ ÑÑ‚ÑƒĞ´ĞµĞ½Ñ‚Ğ¾Ğ² Ğ½Ğ° Ğ½Ğ¾Ğ²Ñ‹Ğ¹ ÑƒÑ‡ĞµĞ±Ğ½Ñ‹Ğ¹ Ğ³Ğ¾Ğ´ Ğ¿Ğ¾ ÑĞ»ĞµĞ´ÑƒÑÑ‰Ğ¸Ğ¼ ÑĞ¿ĞµÑ†Ğ¸Ğ°Ğ»ÑŒĞ½Ğ¾ÑÑ‚ÑĞ¼:</b>\n\n"
        f"â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”“\n"
        f"â”ƒ ğŸ’» <b>Ğ¦Ğ˜Ğ¤Ğ ĞĞ’ĞĞ¯ Ğ¢Ğ•Ğ¥ĞĞ˜ĞšĞ</b>\n"
        f"â”ƒ    (Ñ†ĞµĞ»ĞµĞ²Ğ°Ñ Ğ³Ñ€ÑƒĞ¿Ğ¿Ğ°)\n"
        f"â”ƒ    â€¢ ĞĞ° Ğ±Ğ°Ğ·Ğµ 11 ĞºĞ». â€” 10 Ğ¼ĞµÑ.\n"
        f"â”ƒ\n"
        f"â”ƒ âœ‚ï¸ <b>ĞŸĞĞ Ğ˜ĞšĞœĞĞ¥Ğ•Ğ Ğ¡ĞšĞĞ• Ğ˜Ğ¡ĞšĞ£Ğ¡Ğ¡Ğ¢Ğ’Ğ</b>\n"
        f"â”ƒ    â€¢ ĞĞ° Ğ±Ğ°Ğ·Ğµ 9 ĞºĞ». â€” 2 Ğ³. 10 Ğ¼ĞµÑ.\n"
        f"â”ƒ    â€¢ ĞĞ° Ğ±Ğ°Ğ·Ğµ Ğ¢Ğ¸ĞŸĞ â€” 10 Ğ¼ĞµÑ.\n"
        f"â”ƒ\n"
        f"â”ƒ ğŸ‘— <b>Ğ¨Ğ’Ğ•Ğ™ĞĞĞ• ĞŸĞ ĞĞ˜Ğ—Ğ’ĞĞ”Ğ¡Ğ¢Ğ’Ğ Ğ˜ ĞœĞĞ”Ğ•Ğ›Ğ˜Ğ ĞĞ’ĞĞĞ˜Ğ• ĞĞ”Ğ•Ğ–Ğ”Ğ«</b>\n"
        f"â”ƒ    â€¢ ĞĞ° Ğ±Ğ°Ğ·Ğµ 9 ĞºĞ». â€” 2 Ğ³. 10 Ğ¼ĞµÑ.\n"
        f"â”ƒ    â€¢ ĞĞ° Ğ±Ğ°Ğ·Ğµ Ğ¢Ğ¸ĞŸĞ â€” 10 Ğ¼ĞµÑ.\n"
        f"â”ƒ\n"
        f"â”ƒ ğŸ§µ <b>ĞŸĞĞ Ğ¢ĞĞĞ™</b>\n"
        f"â”ƒ    â€¢ ĞĞ° Ğ±Ğ°Ğ·Ğµ 9 ĞºĞ». â€” 2 Ğ³. 10 Ğ¼ĞµÑ.\n"
        f"â”ƒ\n"
        f"â”ƒ ğŸ‘ <b>ĞĞ‘Ğ£Ğ’ĞĞĞ• Ğ”Ğ•Ğ›Ğ</b>\n"
        f"â”ƒ    â€¢ ĞĞ° Ğ±Ğ°Ğ·Ğµ Ğ¢Ğ¸ĞŸĞ â€” 10 Ğ¼ĞµÑ.\n"
        f"â”ƒ\n"
        f"â”ƒ ğŸ’¼ <b>ĞĞ¤Ğ˜Ğ¡-ĞœĞ•ĞĞ•Ğ”Ğ–Ğ•Ğ </b>\n"
        f"â”ƒ    â€¢ ĞĞ° Ğ±Ğ°Ğ·Ğµ 11 ĞºĞ». â€” 10 Ğ¼ĞµÑ.\n"
        f"â”—â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”›\n\n"
        f"â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—\n"
        f"   ğŸ“‹ <b>Ğ”ĞĞšĞ£ĞœĞ•ĞĞ¢Ğ« Ğ”Ğ›Ğ¯ ĞŸĞĞ¡Ğ¢Ğ£ĞŸĞ›Ğ•ĞĞ˜Ğ¯</b>\n"
        f"â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n\n"
        f"1ï¸âƒ£ Ğ—Ğ°ÑĞ²Ğ»ĞµĞ½Ğ¸Ğµ Ğ¾ Ğ¿Ñ€Ğ¸Ñ‘Ğ¼Ğµ Ğ´Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚Ğ¾Ğ²\n"
        f"2ï¸âƒ£ ĞŸĞ¾Ğ´Ğ»Ğ¸Ğ½Ğ½Ğ¸Ğº Ğ´Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚Ğ° Ğ¾Ğ± Ğ¾Ğ±Ñ€Ğ°Ğ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğ¸ (Ğ°Ñ‚Ñ‚ĞµÑÑ‚Ğ°Ñ‚, Ğ´Ğ¸Ğ¿Ğ»Ğ¾Ğ¼)\n"
        f"3ï¸âƒ£ Ğ¤Ğ¾Ñ‚Ğ¾Ğ³Ñ€Ğ°Ñ„Ğ¸Ğ¸ 3Ã—4 ÑĞ¼ â€” 4 ÑˆÑ‚.\n"
        f"4ï¸âƒ£ ĞœĞµĞ´Ğ¸Ñ†Ğ¸Ğ½ÑĞºĞ°Ñ ÑĞ¿Ñ€Ğ°Ğ²ĞºĞ° Ñ„Ğ¾Ñ€Ğ¼Ñ‹ â„– 075Ğ£\n\n"
        f"â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”“\n"
        f"â”ƒ ğŸŒ <b>Ğ”Ğ»Ñ Ğ¸Ğ½Ğ¾ÑÑ‚Ñ€Ğ°Ğ½Ğ½Ñ‹Ñ… Ğ³Ñ€Ğ°Ğ¶Ğ´Ğ°Ğ½ Ğ¸ Ğ»Ğ¸Ñ† Ğ±ĞµĞ· Ğ³Ñ€Ğ°Ğ¶Ğ´Ğ°Ğ½ÑÑ‚Ğ²Ğ°:</b>\n"
        f"â”ƒ â€¢ Ğ’Ğ¸Ğ´ Ğ½Ğ° Ğ¶Ğ¸Ñ‚ĞµĞ»ÑŒÑÑ‚Ğ²Ğ¾\n"
        f"â”ƒ â€¢ Ğ£Ğ´Ğ¾ÑÑ‚Ğ¾Ğ²ĞµÑ€ĞµĞ½Ğ¸Ğµ Ğ»Ğ¸Ñ†Ğ° Ğ±ĞµĞ· Ğ³Ñ€Ğ°Ğ¶Ğ´Ğ°Ğ½ÑÑ‚Ğ²Ğ°\n"
        f"â”ƒ â€¢ Ğ£Ğ´Ğ¾ÑÑ‚Ğ¾Ğ²ĞµÑ€ĞµĞ½Ğ¸Ğµ Ğ±ĞµĞ¶ĞµĞ½Ñ†Ğ°\n"
        f"â”ƒ â€¢ Ğ£Ğ´Ğ¾ÑÑ‚Ğ¾Ğ²ĞµÑ€ĞµĞ½Ğ¸Ğµ ĞºĞ°Ğ½Ğ´Ğ°ÑĞ°\n"
        f"â”—â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”›\n\n"
        f"â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—\n"
        f"   ğŸ“¤ <b>Ğ¡ĞŸĞĞ¡ĞĞ‘Ğ« ĞŸĞĞ”ĞĞ§Ğ˜ Ğ”ĞĞšĞ£ĞœĞ•ĞĞ¢ĞĞ’</b>\n"
        f"â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n\n"
        f"1ï¸âƒ£ Ğ›Ğ¸Ñ‡Ğ½Ğ¾ Ğ² ĞºĞ¾Ğ»Ğ»ĞµĞ´Ğ¶Ğµ\n"
        f"   ğŸ“ Ğ³. ĞšĞ°Ñ€Ğ°Ğ³Ğ°Ğ½Ğ´Ğ°, ÑƒĞ». Ğ—Ğ°Ñ‚Ğ°ĞµĞ²Ğ¸Ñ‡Ğ°, 75\n\n"
        f"2ï¸âƒ£ Ğ§ĞµÑ€ĞµĞ· Ğ¿Ğ¾Ñ€Ñ‚Ğ°Ğ» ÑĞ»ĞµĞºÑ‚Ñ€Ğ¾Ğ½Ğ½Ğ¾Ğ³Ğ¾ Ğ¿Ñ€Ğ°Ğ²Ğ¸Ñ‚ĞµĞ»ÑŒÑÑ‚Ğ²Ğ° ğŸŒ <b>www.egov.kz</b>\n\n"
        f"3ï¸âƒ£ Ğ§ĞµÑ€ĞµĞ· Ğ¿Ğ»Ğ°Ñ‚Ñ„Ğ¾Ñ€Ğ¼Ñƒ <b>My College</b>\n\n"
        f"â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”“\n"
        f"â”ƒ ğŸ“ <b>ĞŸĞ Ğ˜ĞĞœĞĞĞ¯ ĞšĞĞœĞ˜Ğ¡Ğ¡Ğ˜Ğ¯</b>\n"
        f"â”ƒ ğŸ‘¤ Ó˜Ğ¼Ñ–Ñ€Ñ…Ğ°Ğ½Ğ¾Ğ²Ğ° Ğœ.Ğ. â€” â˜ï¸ 8-701-842-25-36\n"
        f"â”ƒ ğŸ‘¤ Ğ˜ÑĞºĞ°ĞºĞ¾Ğ²Ğ° Ğ“.Ğš. â€” â˜ï¸ 8-700-145-45-36\n"
        f"â”ƒ â° ĞŸĞ½â€“ĞŸÑ‚: 8:00â€“17:00\n"
        f"â”—â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”›\n\n"
        f"âœ… <b>Ğ ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚:</b> Ğ Ğ°ÑĞ¿Ğ¸ÑĞºĞ° Ğ¾ Ğ¿Ñ€Ğ¸Ñ‘Ğ¼Ğµ Ğ´Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚Ğ¾Ğ²\n\n"
        f"ğŸ“š <b>ĞœÑ‹ Ğ¶Ğ´Ñ‘Ğ¼ Ğ²Ğ°Ñ Ğ² Ğ½Ğ°ÑˆĞµĞ¼ ĞºĞ¾Ğ»Ğ»ĞµĞ´Ğ¶Ğµ!</b>"
    )

    await message.answer(admission_text, parse_mode=ParseMode.HTML)
```


# --- ĞĞ¾Ğ²Ğ°Ñ ĞºĞ½Ğ¾Ğ¿ĞºĞ°: Ğ Ğ°ÑĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ Ğ·Ğ²Ğ¾Ğ½ĞºĞ¾Ğ² ---
@dp.message(F.text == "â° Ğ Ğ°ÑĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ Ğ·Ğ²Ğ¾Ğ½ĞºĞ¾Ğ²")
async def show_bell_schedule(message: Message):
    text = (
        "<b>â° Ğ Ğ°ÑĞ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ Ğ·Ğ²Ğ¾Ğ½ĞºĞ¾Ğ²</b>\n\n"
        "<b>ĞŸĞ¾Ğ½ĞµĞ´ĞµĞ»ÑŒĞ½Ğ¸Ğº:</b>\n"
        "ĞšÑƒÑ€Ğ°Ñ‚Ğ¾Ñ€ÑĞºĞ¸Ğ¹ Ñ‡Ğ°Ñ â€” 09:00 â€“ 09:45\n"
        "ĞŸĞµÑ€ĞµĞ¼ĞµĞ½Ğ° â€” 5 Ğ¼Ğ¸Ğ½\n"
        "1 Ğ¿Ğ°Ñ€Ğ° â€” 09:50 â€“ 11:20\n\n"
        "ĞĞ±ĞµĞ´ (1-Ğ¹ Ğ¿Ğ¾Ñ‚Ğ¾Ğº) â€” 20 Ğ¼Ğ¸Ğ½\n"
        "2 Ğ¿Ğ°Ñ€Ğ° â€” 11:40 â€“ 13:10\n\n"
        "ĞĞ±ĞµĞ´ (2-Ğ¹ Ğ¿Ğ¾Ñ‚Ğ¾Ğº) â€” 20 Ğ¼Ğ¸Ğ½\n"
        "3 Ğ¿Ğ°Ñ€Ğ° â€” 13:30 â€“ 15:00\n\n"
        "â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”\n"
        "<b>Ğ’Ñ‚Ğ¾Ñ€Ğ½Ğ¸Ğº â€“ ĞŸÑÑ‚Ğ½Ğ¸Ñ†Ğ°:</b>\n"
        "1 Ğ¿Ğ°Ñ€Ğ° â€” 09:00 â€“ 10:30\n"
        "ĞŸĞµÑ€ĞµĞ¼ĞµĞ½Ğ° â€” 10 Ğ¼Ğ¸Ğ½\n"
        "2 Ğ¿Ğ°Ñ€Ğ° â€” 10:40 â€“ 12:10\n\n"
        "ĞĞ±ĞµĞ´ (1-Ğ¹ Ğ¿Ğ¾Ñ‚Ğ¾Ğº) â€” 20 Ğ¼Ğ¸Ğ½\n"
        "3 Ğ¿Ğ°Ñ€Ğ° â€” 12:30 â€“ 14:00\n\n"
        "ĞĞ±ĞµĞ´ (2-Ğ¹ Ğ¿Ğ¾Ñ‚Ğ¾Ğº) â€” 20 Ğ¼Ğ¸Ğ½\n"
        "4 Ğ¿Ğ°Ñ€Ğ° â€” 14:20 â€“ 15:50"
    )
    await message.answer(text, parse_mode=ParseMode.HTML)

# --- Ğ§Ğ°Ñ‚-Ñ€ĞµĞ¶Ğ¸Ğ¼ ---
@dp.message()
async def chat(message: Message):
    prompt = message.text
    reply = await generate_reply(prompt)
    await message.answer(reply)

# --- ĞÑĞ½Ğ¾Ğ²Ğ½Ğ¾Ğ¹ Ğ·Ğ°Ğ¿ÑƒÑĞº ---
async def main():
    logger.info("âœ… Ğ‘Ğ¾Ñ‚ Ğ·Ğ°Ğ¿ÑƒÑ‰ĞµĞ½ Ğ¸ Ğ³Ğ¾Ñ‚Ğ¾Ğ² Ğº Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğµ Ñ‡ĞµÑ€ĞµĞ· OpenRouter!")
    await dp.start_polling(bot)

if __name__ == "__main__":
    asyncio.run(main())


